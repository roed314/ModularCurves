AttachSpec("~/github/Gm-Reduce/spec");
SetVerbose("GmReduce",true);

// Modular curves downloaded from the LMFDB on 14 March 2024.
// Magma code for modular curve with label 60.160.9.cv.1

// Other names and/or labels
// Cummins-Pauli label: 20A9
// Rouse-Sutherland-Zureick-Brown label: 60.160.9.60

// Group data
level := 60;
// Elements that, together with Gamma(level), generate the group
gens := [[5, 11, 9, 40], [30, 17, 47, 11], [53, 12, 37, 19]];
// Group contains -1?
ContainsMinus1 := true;
// Index in Gamma(1)
index := 160;

// Curve data
conductor := [[2, 28], [3, 8], [5, 16]];
bad_primes := [2, 3, 5];
// Genus
g := 9;
// Rank
r := 4
;// Exact gonality known
//gamma := None;

// Modular data
// Number of cusps
Ncusps := 8
;// Number of rational cusps
Nrat_cusps := 0
;// CM discriminants
CM_discs := [];
// Groups containing given group, corresponding to curves covered by given curve
covers := ["20.80.5.c.1", "60.40.1.s.1", "60.80.3.e.1", "60.80.5.n.1"];

// Models for this modular curve, if computed
Pol<x,y,z,w,t,u,v,r,s> := PolynomialRing(Rationals(), 9);
// Isomorphic to P^1?
is_P1 := false;

// Canonical model
model_0 := [x*y+2*x*z-2*x*t+2*x*u+3*x*v-x*s+y^2+y*z+y*w+y*t-y*v-2*y*s-2*z^2-z*w-z*t+w^2+w*u+w*v+w*r+w*s-t^2-t*u-t*r-u*r-u*s,x*w-x*t-x*u+x*v-2*x*r-2*x*s-y^2+y*z+y*w-y*t-y*u-2*y*s+z*w-z*t+z*u+2*z*v+w^2-2*w*t+w*v+w*r+t^2-t*v+t*s,3*y*u+2*y*v-3*z*w+3*z*t+3*z*u-2*z*v+w^2-2*w*u+w*v+w*s-t^2-2*t*u-t*v-t*s,2*x*y+x*z-2*x*w-2*x*u-3*x*v+x*s+3*y^2-y*z+y*t+y*v+2*y*s-2*z^2-z*w+w^2-w*u-w*v-t^2+t*u-t*s-u*r-u*s,2*x*w-2*x*t-4*x*u-y*w+y*u-y*r-y*s+z*w-z*u-z*r-z*s+w^2+w*v+w*r-t^2+t*v+t*r,2*x*y+x*z-3*x*w+x*t+x*u-2*x*v-2*x*r-x*s+y^2+2*y*w-y*u-2*y*s-z^2-2*z*t+z*u+z*v-2*z*s+w^2+w*u+w*v+w*r+w*s-t^2-t*u+t*s-u*r-u*s,x*u+x*v-2*x*r-2*x*s+y*z-2*y*w+2*y*t+y*u-2*y*v-z^2-z*u+2*z*s+w^2-2*w*t+w*v-w*s+t^2-t*v-t*r,x*y-x*z+x*w-x*t+4*x*v+2*x*s-y*u-y*v-2*y*r-2*y*s+z*w-z*t-z*u+z*v+2*z*r+2*z*s+w^2-w*t-w*u+w*v-t*u-t*v,4*x*y-4*x*z-2*x*w+2*x*t+y^2-2*y*z+y*w+y*t+z^2+z*w+z*t-w^2+w*t+w*u-w*v-t^2-t*u+t*v-u^2-v^2,3*x*z+3*x*w+2*x*v+x*s-y^2+4*y*z-3*y*w+y*t+y*u-y*s-3*z^2+4*z*w+2*z*t+z*u-2*z*v+z*r-w*u+2*w*v-w*r-t^2-2*t*u-2*t*v-u*v+u*s+v^2+v*s+r*s+s^2,3*x*y-3*x*z-x*w+x*t-2*x*u-x*v+2*x*r+2*x*s+2*y^2+2*y*z-2*y*w-3*y*t-y*u-y*v-y*r+2*z^2-z*w-3*z*t-2*z*u+z*v-z*s+w^2-2*w*t+w*u+w*r+t^2+t*u+t*v+v*r-v*s-r*s-s^2,5*x^2+x*y+2*x*z+x*w+2*x*t-2*x*v-x*s+y^2-y*w-3*y*t+y*u-y*v+y*r-y*s+z*w+3*z*t-2*z*v-z*r-3*z*s-w*t+w*u+w*v+t*v+t*s+u^2-u*v+u*s,5*x^2+x*y-x*z-4*x*w-x*t-x*v+2*x*s+2*y*z+y*w-4*y*t-y*u-y*r+5*z^2-z*w-2*z*t+z*r-w*r+2*t^2-t*u+t*r+u*r,x*y+2*x*z-2*x*w-5*x*t+3*x*v-2*x*r-x*s+2*y^2-3*y*z+2*y*w-2*y*t+y*v-2*y*r-y*s+z^2-z*t-z*u+3*z*v+3*z*s+2*w^2+w*t-2*w*u+w*r+t^2+t*u+t*r-u^2-u*s-v^2-v*r,2*x*w-2*x*t-4*x*u-y*u-y*v+y*r+y*s-z*w+z*t+z*u-z*v+z*r+z*s-w^2+w*t+w*u-w*v-w*r-w*s-t*u-t*v-t*r-t*s,3*x*y+3*x*z-x*w-3*x*t-2*x*u-y^2-3*y*z+y*w-y*t-y*v-y*s-2*z^2+4*z*w+2*z*t-z*v-z*s-w^2-w*t+w*v-t^2+u^2-u*v,3*x*y+3*x*z+x*t+x*u-y^2+3*y*z-y*w-2*y*t-y*u+2*y*v+4*z^2-2*z*w-z*t+z*u+2*z*v+w^2+w*t-w*v+t^2+t*r+t*s-u^2+u*v+u*r+u*s,x*w-x*t-2*x*u-2*y^2+4*y*z+2*y*w-y*t-y*u-y*v-y*r-2*z^2+z*w+z*t-2*z*u+z*v-z*s+3*w*t+w*v+w*r-w*s+2*t*u+t*s+u^2+v^2+r^2+r*s+s^2,5*x^2-x*y+x*z+x*u-y*z-2*y*w+y*u-2*y*v-y*r-z^2-2*z*w-z*u+z*r+2*z*s+3*w*t-w*u+2*w*v+w*r+t*u-2*t*v-2*t*r-t*s+u^2+v^2+v*r-v*s+r^2-s^2,2*x*y-2*x*z-x*w+x*t+x*u+2*x*r-y^2-y*w-y*t+y*u-y*v+y*s-2*z^2-z*w-3*z*u-2*z*r-z*s+w^2-2*w*t+3*w*u-2*w*v-w*s+t^2+4*t*v+t*r+t*s-2*u^2-2*v^2-v*r-2*v*s-r^2-2*r*s-s^2,4*x*y-4*x*z+4*x*w-4*x*t+2*x*u-x*v+2*x*r+2*x*s-2*y^2+y*t+y*v+y*r+y*s-z^2+z*w-z*t-2*z*v-z*r-3*z*s-w*t+w*u-w*v-2*w*r-t*u+2*t*v+2*t*r+t*s-v*r-r^2+s^2];

// Singular plane model
model_1 := [4258575*x^16+16160963687631270/671642789*x^15*y+110020687511463882/671642789*x^14*y^2+449994250328242572/671642789*x^13*y^3+1608251945256169038/671642789*x^12*y^4+4247781888188678832/671642789*x^11*y^5+9636653745341219556/671642789*x^10*y^6+17269836230319867324/671642789*x^9*y^7+27329792155426903419/671642789*x^8*y^8+34895937071702841786/671642789*x^7*y^9+41086574926213332474/671642789*x^6*y^10+38121945372338935032/671642789*x^5*y^11+35069458508640149004/671642789*x^4*y^12+22355039448260859744/671642789*x^3*y^13+16769799500488329096/671642789*x^2*y^14+5535732487047207984/671642789*x*y^15+3864813571122123312/671642789*y^16+1871222262755940/671642789*x^15*z-15485817213643662/671642789*x^14*y*z-63244241269551468/671642789*x^13*y^2*z-338315006132357364/671642789*x^12*y^3*z-725959191359551860/671642789*x^11*y^4*z-1837581198694855776/671642789*x^10*y^5*z-2410602352257623184/671642789*x^9*y^6*z-4444340708469488976/671642789*x^8*y^7*z-3870218870906830488/671642789*x^7*y^8*z-6906217347884174490/671642789*x^6*y^9*z-4270503710342193732/671642789*x^5*y^10*z-8171955916018456284/671642789*x^4*y^11*z-3306127194944737416/671642789*x^3*y^12*z-6073601204915915688/671642789*x^2*y^13*z-1131173115437362320/671642789*x*y^14*z-2031663817854749232/671642789*y^15*z+6215117705949708/671642789*x^14*z^2+8225215127329230/671642789*x^13*y*z^2+75307744597378734/671642789*x^12*y^2*z^2+92771407354909950/671642789*x^11*y^3*z^2+544465933032898638/671642789*x^10*y^4*z^2+746031742303704066/671642789*x^9*y^5*z^2+2527435691818517088/671642789*x^8*y^6*z^2+2831038889019128442/671642789*x^7*y^7*z^2+6232640832255787866/671642789*x^6*y^8*z^2+4976647886016786276/671642789*x^5*y^9*z^2+8174758701611000394/671642789*x^4*y^10*z^2+4092870398718742740/671642789*x^3*y^11*z^2+5532010009818266412/671642789*x^2*y^12*z^2+1200613313760222672/671642789*x*y^13*z^2+1598810208651852984/671642789*y^14*z^2+5297243308482528/671642789*x^13*z^3-1630985138618166/671642789*x^12*y*z^3+33484946555959992/671642789*x^11*y^2*z^3-78230159122053330/671642789*x^10*y^3*z^3+40135207501724580/671642789*x^9*y^4*z^3-494026417670287104/671642789*x^8*y^5*z^3-80025415972322292/671642789*x^7*y^6*z^3-1372306013933267862/671642789*x^6*y^7*z^3-271561998399170976/671642789*x^5*y^8*z^3-2085306274718620398/671642789*x^4*y^9*z^3-247611525094059516/671642789*x^3*y^10*z^3-1706530102496079408/671642789*x^2*y^11*z^3-40295661645541680/671642789*x*y^12*z^3-624499070088073968/671642789*y^13*z^3+3858681323416014/671642789*x^12*z^4-447650097615486/671642789*x^11*y*z^4+39080081323139202/671642789*x^10*y^2*z^4+1698211554796440/671642789*x^9*y^3*z^4+201074683924666152/671642789*x^8*y^4*z^4+38711339254545354/671642789*x^7*y^5*z^4+571654293129853254/671642789*x^6*y^6*z^4+101421267133643406/671642789*x^5*y^7*z^4+897763208367759165/671642789*x^4*y^8*z^4+100638782198630892/671642789*x^3*y^9*z^4+763826997733099902/671642789*x^2*y^10*z^4+27606151439988300/671642789*x*y^11*z^4+278070384190968000/671642789*y^12*z^4+1663195772108160/671642789*x^11*z^5-2566623687079626/671642789*x^10*y*z^5+13148099429167440/671642789*x^9*y^2*z^5-23915795179878072/671642789*x^8*y^3*z^5+47893416054378264/671642789*x^7*y^4*z^5-92082852684124758/671642789*x^6*y^5*z^5+83172981051659484/671642789*x^5*y^6*z^5-194727468209764878/671642789*x^4*y^7*z^5+69695438671479024/671642789*x^3*y^8*z^5-202653417077285922/671642789*x^2*y^9*z^5+30922355721449448/671642789*x*y^10*z^5-83884515331134564/671642789*y^11*z^5+531004520309220/671642789*x^10*z^6-1071630006379830/671642789*x^9*y*z^6+6125336270149122/671642789*x^8*y^2*z^6-6978996667656594/671642789*x^7*y^3*z^6+28829573961942186/671642789*x^6*y^4*z^6-15744216447683388/671642789*x^5*y^5*z^6+61234471573041330/671642789*x^4*y^6*z^6-19493039386523898/671642789*x^3*y^7*z^6+60765302848892382/671642789*x^2*y^8*z^6-11397592689884118/671642789*x*y^9*z^6+25047024727089636/671642789*y^10*z^6+80650674293040/671642789*x^9*z^7-416924535923274/671642789*x^8*y*z^7+1530856620799608/671642789*x^7*y^2*z^7-3748307686681170/671642789*x^6*y^3*z^7+5898073663908948/671642789*x^5*y^4*z^7-10398550949428314/671642789*x^4*y^5*z^7+8871464864165916/671642789*x^3*y^6*z^7-12240921128816010/671642789*x^2*y^7*z^7+4983403029410208/671642789*x*y^8*z^7-5702186063035056/671642789*y^9*z^7-2808609577433/671642789*x^8*z^8-62456344641064/671642789*x^7*y*z^8+484077033430900/671642789*x^6*y^2*z^8-760985039437864/671642789*x^5*y^3*z^8+1949044025914342/671642789*x^4*y^4*z^8-1746559723313704/671642789*x^3*y^5*z^8+2637756461442340/671642789*x^2*y^6*z^8-1142541329853880/671642789*x*y^7*z^8+1242569485431295/671642789*y^8*z^8-6330572866900/671642789*x^7*z^9-6993039592200/671642789*x^6*y*z^9+90719702191740/671642789*x^5*y^2*z^9-196367358027320/671642789*x^4*y^3*z^9+313896869091660/671642789*x^3*y^4*z^9-417876907138656/671642789*x^2*y^5*z^9+252778626315740/671642789*x*y^6*z^9-212776955282928/671642789*y^7*z^9-1520398216992/671642789*x^6*z^10+1208203534888/671642789*x^5*y*z^10+17114014053840/671642789*x^4*y^2*z^10-27018297590896/671642789*x^3*y^3*z^10+56850311695936/671642789*x^2*y^4*z^10-39862750645848/671642789*x*y^5*z^10+32808088250864/671642789*y^6*z^10-170683573600/671642789*x^5*z^11+266897992352/671642789*x^4*y*z^11+1791891097008/671642789*x^3*y^2*z^11-4132934960080/671642789*x^2*y^3*z^11+5051237904656/671642789*x*y^4*z^11-3943028092848/671642789*y^5*z^11+11582679280/671642789*x^4*z^12+46763855488/671642789*x^3*y*z^12+154279592448/671642789*x^2*y^2*z^12-313047162848/671642789*x*y^3*z^12+364766125120/671642789*y^4*z^12+5550232608/671642789*x^3*z^13+6041505216/671642789*x^2*y*z^13+4820555616/671642789*x*y^2*z^13-18579660864/671642789*y^3*z^13+703167552/671642789*x^2*z^14+612788160/671642789*x*y*z^14+167629056/671642789*y^2*z^14+41706240/671642789*x*z^15+30612096/671642789*y*z^15+990912/671642789*z^16];

// Maps from this modular curve, if computed

// Map from the canonical model to the canonical model of modular curve with label 20.80.5.c.1
//   Coordinate number 0:
map_0_coord_0 := 1*(-x);
//   Coordinate number 1:
map_0_coord_1 := 1*(z);
//   Coordinate number 2:
map_0_coord_2 := 1*(y);
//   Coordinate number 3:
map_0_coord_3 := 1*(t);
//   Coordinate number 4:
map_0_coord_4 := 1*(-w);
// Codomain equation:
map_0_codomain := [10*x^2+4*y^2+6*y*z+4*z^2-y*w-5*z*w+3*w^2+5*y*t+z*t+2*w*t+3*t^2,15*x*y+y^2+15*x*z-z^2-5*x*w-2*y*w+z*w+2*w^2+5*x*t+y*t-2*z*t-2*t^2,10*x^2-10*x*y-9*y^2+10*x*z+8*y*z-9*z^2-10*x*w+4*y*w+6*z*w-w^2-10*x*t-6*y*t-4*z*t+8*w*t-t^2];

// Map from the canonical model to the plane model of modular curve with label 60.160.9.cv.1
//   Coordinate number 0:
map_1_coord_0 := 1*(v);
//   Coordinate number 1:
map_1_coord_1 := 1*(u);
//   Coordinate number 2:
map_1_coord_2 := 1*(3*s);
// Codomain equation:
map_1_codomain := [4258575*x^16+16160963687631270/671642789*x^15*y+110020687511463882/671642789*x^14*y^2+449994250328242572/671642789*x^13*y^3+1608251945256169038/671642789*x^12*y^4+4247781888188678832/671642789*x^11*y^5+9636653745341219556/671642789*x^10*y^6+17269836230319867324/671642789*x^9*y^7+27329792155426903419/671642789*x^8*y^8+34895937071702841786/671642789*x^7*y^9+41086574926213332474/671642789*x^6*y^10+38121945372338935032/671642789*x^5*y^11+35069458508640149004/671642789*x^4*y^12+22355039448260859744/671642789*x^3*y^13+16769799500488329096/671642789*x^2*y^14+5535732487047207984/671642789*x*y^15+3864813571122123312/671642789*y^16+1871222262755940/671642789*x^15*z-15485817213643662/671642789*x^14*y*z-63244241269551468/671642789*x^13*y^2*z-338315006132357364/671642789*x^12*y^3*z-725959191359551860/671642789*x^11*y^4*z-1837581198694855776/671642789*x^10*y^5*z-2410602352257623184/671642789*x^9*y^6*z-4444340708469488976/671642789*x^8*y^7*z-3870218870906830488/671642789*x^7*y^8*z-6906217347884174490/671642789*x^6*y^9*z-4270503710342193732/671642789*x^5*y^10*z-8171955916018456284/671642789*x^4*y^11*z-3306127194944737416/671642789*x^3*y^12*z-6073601204915915688/671642789*x^2*y^13*z-1131173115437362320/671642789*x*y^14*z-2031663817854749232/671642789*y^15*z+6215117705949708/671642789*x^14*z^2+8225215127329230/671642789*x^13*y*z^2+75307744597378734/671642789*x^12*y^2*z^2+92771407354909950/671642789*x^11*y^3*z^2+544465933032898638/671642789*x^10*y^4*z^2+746031742303704066/671642789*x^9*y^5*z^2+2527435691818517088/671642789*x^8*y^6*z^2+2831038889019128442/671642789*x^7*y^7*z^2+6232640832255787866/671642789*x^6*y^8*z^2+4976647886016786276/671642789*x^5*y^9*z^2+8174758701611000394/671642789*x^4*y^10*z^2+4092870398718742740/671642789*x^3*y^11*z^2+5532010009818266412/671642789*x^2*y^12*z^2+1200613313760222672/671642789*x*y^13*z^2+1598810208651852984/671642789*y^14*z^2+5297243308482528/671642789*x^13*z^3-1630985138618166/671642789*x^12*y*z^3+33484946555959992/671642789*x^11*y^2*z^3-78230159122053330/671642789*x^10*y^3*z^3+40135207501724580/671642789*x^9*y^4*z^3-494026417670287104/671642789*x^8*y^5*z^3-80025415972322292/671642789*x^7*y^6*z^3-1372306013933267862/671642789*x^6*y^7*z^3-271561998399170976/671642789*x^5*y^8*z^3-2085306274718620398/671642789*x^4*y^9*z^3-247611525094059516/671642789*x^3*y^10*z^3-1706530102496079408/671642789*x^2*y^11*z^3-40295661645541680/671642789*x*y^12*z^3-624499070088073968/671642789*y^13*z^3+3858681323416014/671642789*x^12*z^4-447650097615486/671642789*x^11*y*z^4+39080081323139202/671642789*x^10*y^2*z^4+1698211554796440/671642789*x^9*y^3*z^4+201074683924666152/671642789*x^8*y^4*z^4+38711339254545354/671642789*x^7*y^5*z^4+571654293129853254/671642789*x^6*y^6*z^4+101421267133643406/671642789*x^5*y^7*z^4+897763208367759165/671642789*x^4*y^8*z^4+100638782198630892/671642789*x^3*y^9*z^4+763826997733099902/671642789*x^2*y^10*z^4+27606151439988300/671642789*x*y^11*z^4+278070384190968000/671642789*y^12*z^4+1663195772108160/671642789*x^11*z^5-2566623687079626/671642789*x^10*y*z^5+13148099429167440/671642789*x^9*y^2*z^5-23915795179878072/671642789*x^8*y^3*z^5+47893416054378264/671642789*x^7*y^4*z^5-92082852684124758/671642789*x^6*y^5*z^5+83172981051659484/671642789*x^5*y^6*z^5-194727468209764878/671642789*x^4*y^7*z^5+69695438671479024/671642789*x^3*y^8*z^5-202653417077285922/671642789*x^2*y^9*z^5+30922355721449448/671642789*x*y^10*z^5-83884515331134564/671642789*y^11*z^5+531004520309220/671642789*x^10*z^6-1071630006379830/671642789*x^9*y*z^6+6125336270149122/671642789*x^8*y^2*z^6-6978996667656594/671642789*x^7*y^3*z^6+28829573961942186/671642789*x^6*y^4*z^6-15744216447683388/671642789*x^5*y^5*z^6+61234471573041330/671642789*x^4*y^6*z^6-19493039386523898/671642789*x^3*y^7*z^6+60765302848892382/671642789*x^2*y^8*z^6-11397592689884118/671642789*x*y^9*z^6+25047024727089636/671642789*y^10*z^6+80650674293040/671642789*x^9*z^7-416924535923274/671642789*x^8*y*z^7+1530856620799608/671642789*x^7*y^2*z^7-3748307686681170/671642789*x^6*y^3*z^7+5898073663908948/671642789*x^5*y^4*z^7-10398550949428314/671642789*x^4*y^5*z^7+8871464864165916/671642789*x^3*y^6*z^7-12240921128816010/671642789*x^2*y^7*z^7+4983403029410208/671642789*x*y^8*z^7-5702186063035056/671642789*y^9*z^7-2808609577433/671642789*x^8*z^8-62456344641064/671642789*x^7*y*z^8+484077033430900/671642789*x^6*y^2*z^8-760985039437864/671642789*x^5*y^3*z^8+1949044025914342/671642789*x^4*y^4*z^8-1746559723313704/671642789*x^3*y^5*z^8+2637756461442340/671642789*x^2*y^6*z^8-1142541329853880/671642789*x*y^7*z^8+1242569485431295/671642789*y^8*z^8-6330572866900/671642789*x^7*z^9-6993039592200/671642789*x^6*y*z^9+90719702191740/671642789*x^5*y^2*z^9-196367358027320/671642789*x^4*y^3*z^9+313896869091660/671642789*x^3*y^4*z^9-417876907138656/671642789*x^2*y^5*z^9+252778626315740/671642789*x*y^6*z^9-212776955282928/671642789*y^7*z^9-1520398216992/671642789*x^6*z^10+1208203534888/671642789*x^5*y*z^10+17114014053840/671642789*x^4*y^2*z^10-27018297590896/671642789*x^3*y^3*z^10+56850311695936/671642789*x^2*y^4*z^10-39862750645848/671642789*x*y^5*z^10+32808088250864/671642789*y^6*z^10-170683573600/671642789*x^5*z^11+266897992352/671642789*x^4*y*z^11+1791891097008/671642789*x^3*y^2*z^11-4132934960080/671642789*x^2*y^3*z^11+5051237904656/671642789*x*y^4*z^11-3943028092848/671642789*y^5*z^11+11582679280/671642789*x^4*z^12+46763855488/671642789*x^3*y*z^12+154279592448/671642789*x^2*y^2*z^12-313047162848/671642789*x*y^3*z^12+364766125120/671642789*y^4*z^12+5550232608/671642789*x^3*z^13+6041505216/671642789*x^2*y*z^13+4820555616/671642789*x*y^2*z^13-18579660864/671642789*y^3*z^13+703167552/671642789*x^2*z^14+612788160/671642789*x*y*z^14+167629056/671642789*y^2*z^14+41706240/671642789*x*z^15+30612096/671642789*y*z^15+990912/671642789*z^16];

f := model_1[1];
fred := reducemodel_padic(f);
